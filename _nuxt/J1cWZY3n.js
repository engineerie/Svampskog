const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./B9rKIRhJ.js","./Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{_ as Yt,B as Va,W as N,d as ie,e as te,N as ja,f as de,h as U,aC as Na,n as Pe,g as ct,aP as Ha,bf as Zt,bI as Da,bJ as Ga,t as pe,b1 as Ye,w as Ot,bg as Ba,ai as Wa,P as At,r as W,aE as Ze,aF as Ke,o as Rt,by as Ua,K as A,aR as qa,L as Je,b as Ct,q as It}from"#entry";import{c as He,g as Xa}from"./Cpj98o6Y.js";import{b as Kt,D as Ya,c as Za}from"./9ARKGlh3.js";import"./F1oM1-Dy.js";import"./BCyEsDtN.js";import"./CudAv0bZ.js";import"./CfH1fzDF.js";import"./DQT6uneS.js";import"./DEqKqFR3.js";import"./CADCHXif.js";var Qe,Lt;function Jt(){if(Lt)return Qe;Lt=1;function a(f){var h=typeof f;return f!=null&&(h=="object"||h=="function")}return Qe=a,Qe}var $e,Et;function Ka(){if(Et)return $e;Et=1;var a=typeof He=="object"&&He&&He.Object===Object&&He;return $e=a,$e}var et,Ft;function Qt(){if(Ft)return et;Ft=1;var a=Ka(),f=typeof self=="object"&&self&&self.Object===Object&&self,h=a||f||Function("return this")();return et=h,et}var tt,Vt;function Ja(){if(Vt)return tt;Vt=1;var a=Qt(),f=function(){return a.Date.now()};return tt=f,tt}var at,jt;function Qa(){if(jt)return at;jt=1;var a=/\s/;function f(h){for(var c=h.length;c--&&a.test(h.charAt(c)););return c}return at=f,at}var rt,Nt;function $a(){if(Nt)return rt;Nt=1;var a=Qa(),f=/^\s+/;function h(c){return c&&c.slice(0,a(c)+1).replace(f,"")}return rt=h,rt}var nt,Ht;function $t(){if(Ht)return nt;Ht=1;var a=Qt(),f=a.Symbol;return nt=f,nt}var it,Dt;function er(){if(Dt)return it;Dt=1;var a=$t(),f=Object.prototype,h=f.hasOwnProperty,c=f.toString,O=a?a.toStringTag:void 0;function q(G){var E=h.call(G,O),D=G[O];try{G[O]=void 0;var _=!0}catch{}var Y=c.call(G);return _&&(E?G[O]=D:delete G[O]),Y}return it=q,it}var ot,Gt;function tr(){if(Gt)return ot;Gt=1;var a=Object.prototype,f=a.toString;function h(c){return f.call(c)}return ot=h,ot}var st,Bt;function ar(){if(Bt)return st;Bt=1;var a=$t(),f=er(),h=tr(),c="[object Null]",O="[object Undefined]",q=a?a.toStringTag:void 0;function G(E){return E==null?E===void 0?O:c:q&&q in Object(E)?f(E):h(E)}return st=G,st}var lt,Wt;function rr(){if(Wt)return lt;Wt=1;function a(f){return f!=null&&typeof f=="object"}return lt=a,lt}var dt,Ut;function nr(){if(Ut)return dt;Ut=1;var a=ar(),f=rr(),h="[object Symbol]";function c(O){return typeof O=="symbol"||f(O)&&a(O)==h}return dt=c,dt}var ut,qt;function ir(){if(qt)return ut;qt=1;var a=$a(),f=Jt(),h=nr(),c=NaN,O=/^[-+]0x[0-9a-f]+$/i,q=/^0b[01]+$/i,G=/^0o[0-7]+$/i,E=parseInt;function D(_){if(typeof _=="number")return _;if(h(_))return c;if(f(_)){var Y=typeof _.valueOf=="function"?_.valueOf():_;_=f(Y)?Y+"":Y}if(typeof _!="string")return _===0?_:+_;_=a(_);var $=q.test(_);return $||G.test(_)?E(_.slice(2),$?2:8):O.test(_)?c:+_}return ut=D,ut}var mt,Xt;function or(){if(Xt)return mt;Xt=1;var a=Jt(),f=Ja(),h=ir(),c="Expected a function",O=Math.max,q=Math.min;function G(E,D,_){var Y,$,ue,oe,Z,se,me=0,_e=!1,ce=!1,ve=!0;if(typeof E!="function")throw new TypeError(c);D=h(D)||0,a(_)&&(_e=!!_.leading,ce="maxWait"in _,ue=ce?O(h(_.maxWait)||0,D):ue,ve="trailing"in _?!!_.trailing:ve);function fe(C){var re=Y,K=$;return Y=$=void 0,me=C,oe=E.apply(K,re),oe}function i(C){return me=C,Z=setTimeout(J,D),_e?fe(C):oe}function Ve(C){var re=C-se,K=C-me,be=D-re;return ce?q(be,ue-K):be}function T(C){var re=C-se,K=C-me;return se===void 0||re>=D||re<0||ce&&K>=ue}function J(){var C=f();if(T(C))return F(C);Z=setTimeout(J,Ve(C))}function F(C){return Z=void 0,ve&&Y?fe(C):(Y=$=void 0,oe)}function Q(){Z!==void 0&&clearTimeout(Z),me=0,Y=se=$=Z=void 0}function ge(){return Z===void 0?oe:F(f())}function ae(){var C=f(),re=T(C);if(Y=arguments,$=this,se=C,re){if(Z===void 0)return i(se);if(ce)return clearTimeout(Z),Z=setTimeout(J,D),fe(se)}return Z===void 0&&(Z=setTimeout(J,D)),oe}return ae.cancel=Q,ae.flush=ge,ae}return mt=G,mt}var sr=or();const lr=Xa(sr),dr={};function ur(a,f){return null}const mr=Object.assign(Yt(dr,[["render",ur]]),{__name:"AnnotationPopup"}),cr={class:"w-full flex justify-center z-30"},vr=Va({__name:"AnnotationMarker",props:{annotation:{}},setup(a){const f=a,h=Kt(),c=N(()=>h.selectedAnnotation?.id===f.annotation.id);function O(){h.setSelectedAnnotation(f.annotation)}return(q,G)=>{const E=Na,D=Ha;return te(),ie("div",{class:"cursor-pointer",onClick:O},[c.value?(te(),ja(E,{key:0,label:q.annotation.title,color:"neutral",class:"bg-neutral-800/20 backdrop-blur-2xl"},null,8,["label"])):de("",!0),U("div",cr,[U("div",{class:Pe(["relative transition-all",(c.value,"size-8")])},[ct(D,{name:q.annotation.icon,class:Pe(["absolute transition-all z-8",c.value?"size-8 text-green-500":"size-8 text-"+q.annotation.color])},null,8,["name","class"]),ct(D,{name:q.annotation.iconOutline,class:Pe(["absolute transition-all z-20",(c.value,"size-8 text-white")])},null,8,["name","class"])],2)])])}}}),fr=Object.assign(vr,{__name:"AnnotationMarker"}),gr=JSON.parse('[{"startskog":"naturskog","atgard":"naturskydd","tid":"innan","skog":"Äldre skog.","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Rödlistade svampar kan finnas. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"naturskog","atgard":"naturskydd","tid":"efter","skog":"Viss intern dynamik med träd som dör och självföryngring.","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Rödlistade svampar kan finnas. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"naturskog","atgard":"naturskydd","tid":"20 år","skog":"Viss intern dynamik med träd som dör och självföryngring.","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Rödlistade svampar kan finnas. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"naturskog","atgard":"naturskydd","tid":"50 år","skog":"Viss intern dynamik med träd som dör och självföryngring.","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Rödlistade svampar kan finnas. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"naturskog","atgard":"naturskydd","tid":"80 år","skog":"Viss intern dynamik med träd som dör och självföryngring.","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Rödlistade svampar kan finnas. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"naturskog","atgard":"trakthygge","tid":"innan","skog":"Äldre skog.","svamp":"Rikligt med mykorhizasvamp med många olika arter.Goda förutsättningar för matsvampar. Rödlistade svampar kan finnas. Gamla svampindivider kan ha stora mycelstorlekar."},{"startskog":"naturskog","atgard":"trakthygge","tid":"efter","skog":"Kalaverkning med 5%  naturhänsyn i form av  enstaka och grupper av hänsynsträd samt högstubbar.","svamp":"Merparten av mykorrhizasvamparnas mycel tynar bort och dör. Svampmycel överlever vid hänsynsträd, längs med hyggeskanterna och på kvarväxande småplantor."},{"startskog":"naturskog","atgard":"trakthygge","tid":"20 år","skog":"Trädplantor som sattes efter avverkning  är nu 5-10 meter hög ungskog .","svamp":"Successivt återetableras mykorrhizasvampar med vindspridda sporer från näraliggande skogar. Betydligt mindre mängd mykorrhiza och färre arter än  i äldre skog. Matsvampar saknas ofta helt."},{"startskog":"naturskog","atgard":"trakthygge","tid":"50 år","skog":"Uppvuxen skog. En gallring av  30% av beståndets stamantal har skett. Sker 1-3 gånger under ett  bestånds omloppstid.","svamp":"Mängd och artantal mykorrhizasvampar närmar sig vad som finns I äldre skog. Matsvampar, t ex stensopp, blir allt vanligare. Gallringen påverkar inte förekomsten av mykorrhizasvamparna nämnvärt."},{"startskog":"naturskog","atgard":"trakthygge","tid":"80 år","skog":"Kan beroende på markbördighet och var in Sverige komma att avverkas vid mellan 60 till + 100 års beståndsålder.","svamp":"Förekomsten av vanliga mykorrhizasvampar, mängd och artantal är ungefär samma som före avverkningen. Ofta bra för matsvampar. Någon rödlistad art kan ha fortlevt på lämnade evighetsträd och någon kan sällsynt ha spridits in och etableras om den finns i närheten."},{"startskog":"naturskog","atgard":"luckhuggning","tid":"innan","skog":"Äldre skog.","svamp":"Rikligt med mykorhizasvamp med många olika arter.Goda förutsättningar för matsvampar. Rödlistade svampar kan finnas. Gamla svampindivider kan ha stora mycelstorlekar."},{"startskog":"naturskog","atgard":"luckhuggning","tid":"efter","skog":"Avverkning i mindre luckor i 1/3 av beståndet. Skogen i resten av beståndet är inakt.","svamp":"Luckorna fungerar som små hyggen. Mykorrhiza på omgivande träds rötter som sträcker sig ca 10 m in i luckorna forlever. Den ohuggna skogens mykorrhizasvamparna fortlever. Sammantaget minskad mängd matsvamp."},{"startskog":"naturskog","atgard":"luckhuggning","tid":"20 år","skog":"Självföryngrade träd har börjat växa upp i luckorna.","svamp":"Opåverkat svampsamhället i den ohuggna delen av beståndet.  Mykorrhizasvampar från mycel och sporer etablerar sig på självföryngrade trädplantor. Minskad mängd matsvamp."},{"startskog":"naturskog","atgard":"luckhuggning","tid":"50 år","skog":"Efter 30 år gjordes nya luckhuggningar på 1/3 av beståndet. Träden i de första luckorna närmar sig 50 år och i de nyare luckorna 20 år.","svamp":"Uppväxande trädplantor etableras av samma mykorrhizasvampar som funnits på platsen. Matsvamp liksom ovanliga och rödlistande svampar fortlever i ursprungsskogen och kan etableras på de uppväxande träden."},{"startskog":"naturskog","atgard":"luckhuggning","tid":"80 år","skog":"Efter ca 60 år avverkas resten av beståndet.Träden är nu ca 80 år i de äldsta luckorna och 50, respektive  20, år i de yngre luckorna.","svamp":"Förekomsten av vanliga mykorrhizasvampar, mängd och artantal är hela tiden något lägre än före avverkningen pga av luckorna. Mängd matsvamp bedöms god. En del eventuella ursprungliga förekomster av  rödlistade svampar bedöms kunna ha fortlevt."},{"startskog":"naturskog","atgard":"skärmträd","tid":"innan","skog":"Äldre skog","svamp":"Rikligt med mykorhizasvamp med många olika arter.Goda förutsättningar för matsvampar. Rödlistade svampar kan finnas. Gamla svampindivider kan ha stora mycelstorlekar."},{"startskog":"naturskog","atgard":"skärmträd","tid":"efter","skog":"Föreberedande avverkning som lämnar 300-400 skärmträd/ha.","svamp":"Mängden mykorrhiza halveras då ungefär hälften av beståndet träd avverkas.  Alla vanliga och de flesta ovanligare svamparterna fortlever på skärmträdens rötter som täcker merparten av beståndets yta."},{"startskog":"naturskog","atgard":"skärmträd","tid":"10 år","skog":"Avverkning som lämnar 75-150 fröträd/ha.","svamp":"Mängden mykorrhiza minskar med färre träd.  Artsammansättningen av påverkas mindre. Vanliga svamparterna fortlever på fröträdens rötter. Minskad sannolikheten att ovanligare arter kan leva vidare. Som regel förekommer de bara med enstaka mycel i en skog."},{"startskog":"naturskog","atgard":"skärmträd","tid":"20 år","skog":"När självföryngrade trädplantor etablerats och vuxit sig ca 2 meter höga avverkas fröträden. Hänsynsträd lämnas.","svamp":"Mycel från många mykorrhizasvampar på skärmträdenss  rötter bedöms ha etablerats på de naturligt föryngrade plantornas rötter. Mängden mykorrhiza går ner men merparten av arter fortlever. Lite matsvamp. En del ovanligare och ev förekomster av rödlistade arter kan ha  fortlevt på hänsynsträd och kan ha etablerats på de yngre trädplantorna."},{"startskog":"naturskog","atgard":"skärmträd","tid":"50 år","skog":"Uppvuxen skog.","svamp":"Mängd och artantal mykorrhizasvampar är ungefär vad som finns i äldre skog. Samma förekomsten av vanlig arter. En  del av  ursprungliga mat- ovanligare och rödlistade svamp arter bedöms fortleva. Potentiellt god tillgång på matsvampar."},{"startskog":"naturskog","atgard":"skärmträd","tid":"80 år","skog":"Äldre skog. Snart dags att skapa skärmträdställning igen.","svamp":"Artantal, mängd mykorrhizasvampar och tillgång på matsvampar bedöms vara ungefär som före friställande av skärmträd. En del av de ursprungliga ovanligare och rödlistade arterna bedöms fortleva i beståndet."},{"startskog":"naturskog","atgard":"blädning","tid":"innan","skog":"Äldre skog","svamp":"Rikligt med mykorhizasvamp med många olika arter.Goda förutsättningar för matsvampar. Rödlistade svampar kan finnas. Gamla svampindivider kan ha stora mycelstorlekar."},{"startskog":"naturskog","atgard":"blädning","tid":"efter","skog":"Avverkning av ca 1/3 av träden utspritt i beståndet.  Ger plats åt mindre och yngre träd att växa till.","svamp":"Liten påverkan på mykorrhizasvampar. Artsammansättningen i princip opåverkan. Tillfällig mindre nedgång i mängd mykorrhiza som följd av lägre fotosyntes pga blädningen. Bedöms bra för matsvampar."},{"startskog":"naturskog","atgard":"blädning","tid":"20 år","skog":"Mindre och yngre träd växer upp till och börjar fylla i luckigheten  som bildades vid blädningen.","svamp":"Artsammansättning och mängd mykorrhiza bedöms vara ungefär samma som före blädningen för såväl vanliga arter, mat- ovanligare och rödlistade arter.  Bedöms bra för matsvampar."},{"startskog":"naturskog","atgard":"blädning","tid":"50 år","skog":"Ny blädningsomgång där ytterligare 1/3 av träden avverkas. Ger utrymme åt nya mindre och yngre träd att växa till.","svamp":"Fortsatt liten påverkan på mykorrhizasvampar. Artsammansättningen i princip opåverkad. Tillfällig mindre nedgång i mängden mykorrhiza som följd av lägre sammanlagd fotosyntes pga blädningen.  Bedöms bra för matsvampar."},{"startskog":"naturskog","atgard":"blädning","tid":"80 år","skog":"Ungefär 60 år efter den första blädningen avverkas den sista tredjedelen av träden från det ursprungliga beståndet.","svamp":"Artsammansättning och mängd mykorrhiza bedöms vara fortsatt ungefär samma som före blädningen för såväl vanliga arter, mat- ovanligare och rödlistade arter. Bedöms bra för matsvampar."},{"startskog":"produktionsskog_","atgard":"naturskydd","tid":"innan","skog":"Äldre tidigare kalavverkad skog","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Oftast saknas rödlistade svampar. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"produktionsskog_","atgard":"naturskydd","tid":"efter","skog":"Viss intern dynamik med träd som dör och självföryngring.","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Oftast saknas rödlistade svampar. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"produktionsskog_","atgard":"naturskydd","tid":"20 år","skog":"Viss intern dynamik med träd som dör och självföryngring.","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Oftast saknas rödlistade svampar. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"produktionsskog_","atgard":"naturskydd","tid":"50 år","skog":"Viss intern dynamik med träd som dör och självföryngring.","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Oftast saknas rödlistade svampar. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"produktionsskog_","atgard":"naturskydd","tid":"80 år","skog":"Viss intern dynamik med träd som dör och självföryngring.","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Oftast saknas rödlistade svampar. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"produktionsskog_","atgard":"trakthygge","tid":"innan","skog":"Äldre tidigare kalavverkad skog","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Oftast saknas rödlistade svampar. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"produktionsskog_","atgard":"trakthygge","tid":"efter","skog":"Kalaverkning med 5%  naturhänsyn i form av  enstaka och grupper av hänsynsträd samt högstubbar.","svamp":"Merparten av mykorrhizasvamparnas mycel tynar bort och dör. Svampmycel överlever vid hänsynsträd, längs med hyggeskanterna och på kvarväxande småplantor."},{"startskog":"produktionsskog_","atgard":"trakthygge","tid":"20 år","skog":"Trädplantor som sattes efter avverkning  är nu 5-10 meter hög ungskog .","svamp":"Successivt återetableras mykorrhizasvampar med vindspridda sporer från näraliggande skogar. Betydligt mindre mängd mykorrhiza och färre arter än  i äldre skog. Matsvampar saknas ofta helt."},{"startskog":"produktionsskog_","atgard":"trakthygge","tid":"50 år","skog":"Uppvuxen skog. En gallring av  30% av beståndets stamantal har skett. Sker 1-3 gånger under ett  bestånds omloppstid.","svamp":"Mängd och artantal mykorrhizasvampar närmar sig vad som finns I äldre skog. Matsvampar, t ex stensopp, blir allt vanligare. Gallringen påverkar inte förekomsten av mykorrhizasvamparna nämnvärt."},{"startskog":"produktionsskog_","atgard":"trakthygge","tid":"80 år","skog":"Kan beroende på markbördighet och var in Sverige komma att avverkas vid mellan 60 till + 100 års beståndsålder.","svamp":"Förekomsten av vanliga mykorrhizasvampar, mängd och artantal är ungefär samma som före avverkningen. Ofta bra för matsvampar. Någon rödlistad art kan ha lyckats etableras från sporer om de  förekommer i näraliggande skogar."},{"startskog":"produktionsskog_","atgard":"luckhuggning","tid":"innan","skog":"Äldre tidigare kalavverkad skog","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Oftast saknas rödlistade svampar. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"produktionsskog_","atgard":"luckhuggning","tid":"efter","skog":"Avverkning i mindre luckor i 1/3 av beståndet. Skogen i resten av beståndet är inakt.","svamp":"Luckorna fungerar som små hyggen. Mykorrhiza på omgivande träds rötter som sträcker sig ca 10 m in i luckorna forlever. Den ohuggna skogens mykorrhizasvamparna fortlever, men sammantaget minskar matsvampar och eventuell förekomst av rödlistade arter i beståndet."},{"startskog":"produktionsskog_","atgard":"luckhuggning","tid":"20 år","skog":"Självföryngrade träd har börjat växa upp i luckorna.","svamp":"Fortsatt opåverkat svampsamhället i den ohuggna delen av beståndet.  Mykorrhizasvampar från mycel och sporer på platsen etablerar sig på självföryngrade trädplantor.  Minskad mängd matsvamp."},{"startskog":"produktionsskog_","atgard":"luckhuggning","tid":"50 år","skog":"Efter 30 år gjordes nya luckhuggningar på 1/3 av beståndet. Träden i de första luckorna närmar sig 50 år och i de nyare luckorna 20 år.","svamp":"Artantal och mykorrhizamängd minskar under ett par decennier i luckorna. Uppväxande trädplantor etableras av samma mykorrhizasvampar som funnits på platsen. Förekomsten av matsvamp liksom ovanliga och rödlistande svampar fortlever i ursprungsskogen och kan etableras på de uppväxande träden."},{"startskog":"produktionsskog_","atgard":"luckhuggning","tid":"80 år","skog":"Efter ca 60 år avverkas resten av beståndet.Träden är nu ca 80 år i de äldsta luckorna och 50, respektive  20, år i de yngre luckorna.","svamp":"Förekomsten av vanliga mykorrhizasvampar, mängd och artantal är hela tiden något lägre än före avverkningen pga av luckorna. Mängd matsvamp bedöms god. En del eventuella ursprungliga förekomster av  rödlistade svampar bedöms kunna ha fortlevt."},{"startskog":"produktionsskog_","atgard":"skärmträd","tid":"innan","skog":"Äldre tidigare kalavverkad skog","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Oftast saknas rödlistade svampar. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"produktionsskog_","atgard":"skärmträd","tid":"efter","skog":"Föreberedande avverkning som lämnar 300-400 skärmträd/ha.","svamp":"Mängden mykorrhiza halveras då ungefär hälften av beståndet träd avverkas.  Alla vanliga och de flesta ovanligare svamparterna fortlever på skärmträdens rötter som täcker merparten av beståndets yta."},{"startskog":"produktionsskog_","atgard":"skärmträd","tid":"10 år","skog":"Avverkning som lämnar 75-150 fröträd/ha.","svamp":"Mängden mykorrhiza minskar med färre träd.  Artsammansättningen av påverkas mindre. Vanliga svamparterna fortlever på fröträdens rötter. Minskad sannolikheten att ovanligare arter kan leva vidare. Som regel förekommer de bara med enstaka mycel i en skog."},{"startskog":"produktionsskog_","atgard":"skärmträd","tid":"20 år","skog":"När självföryngrade trädplantor etablerats och vuxit sig ca 2 meter höga avverkas fröträden. Hänsynsträd lämnas.","svamp":"Mycel från många mykorrhizasvampar på skärmträdenss  rötter bedöms ha etablerats på de naturligt föryngrade plantornas rötter. Mängden mykorrhiza går ner men merparten av arter fortlever. Lite matsvamp."},{"startskog":"produktionsskog_","atgard":"skärmträd","tid":"50 år","skog":"Uppvuxen skog.","svamp":"Mängd och artantal mykorrhizasvampar är ungefär vad som finns i äldre skog. Samma förekomst av vanliga arter.  Potentiellt god tillgång på matsvampar."},{"startskog":"produktionsskog_","atgard":"skärmträd","tid":"80 år","skog":"Äldre skog. Snart dags att skapa skärmträdställning igen.","svamp":"Artantal, mängd mykorrhizasvampar och tillgång på matsvampar bedöms vara ungefär som före friställande av skärmträd.  Eventuell ursprunglig förekomst av  rödlistade svampar bedöms kunna ha fortlevt bättre än vid trakthyggebruk."},{"startskog":"produktionsskog_","atgard":"blädning","tid":"innan","skog":"Äldre tidigare kalavverkad skog","svamp":"Rikligt med mykorhizasvamp med många olika arter. Goda förutsättningar för matsvampar. Oftast saknas rödlistade svampar. Gamla svampindivider som kan ha stora mycelstorlekar."},{"startskog":"produktionsskog_","atgard":"blädning","tid":"efter","skog":"Avverkning av ca 1/3 av träden utspritt i beståndet.  Ger plats åt mindre och yngre träd att växa till.","svamp":"Liten påverkan på mykorrhizasvampar. Artsammansättningen i princip opåverkan. Tillfällig mindre nedgång i mängd mykorrhiza som följd av lägre fotosyntes pga blädningen.  Bedöms bra för matsvampar."},{"startskog":"produktionsskog_","atgard":"blädning","tid":"20 år","skog":"Mindre och yngre träd växer upp till och börjar fylla i luckigheten  som bildades vid blädningen.","svamp":"Artsammansättning och mängd mykorrhiza bedöms vara ungefär samma som före blädningen för såväl vanliga arter, mat- ovanligare och rödlistade arter.  Bedöms bra för matsvampar."},{"startskog":"produktionsskog_","atgard":"blädning","tid":"50 år","skog":"Ny blädningsomgång där ytterligare 1/3 av träden avverkas. Ger utrymme åt nya mindre och yngre träd att växa till.","svamp":"Fortsatt liten påverkan på mykorrhizasvampar. Artsammansättningen i princip opåverkad. Tillfällig mindre nedgång i mängden mykorrhiza som följd av lägre sammanlagd fotosyntes pga blädningen.  Bedöms bra för matsvampar."},{"startskog":"produktionsskog_","atgard":"blädning","tid":"80 år","skog":"Ungefär 60 år efter den första blädningen avverkas den sista tredjedelen av träden från det ursprungliga beståndet.","svamp":"Fortsatt liten påverkan på mykorrhizasvampar. Artsammansättning och mängd mykorrhiza bedöms vara fortsatt ungefär samma som före blädningen för såväl vanliga arter, mat- ovanligare och rödlistade arter.  Bedöms bra för matsvampar."}]'),kr=Zt("panel",{state:()=>({isPanelMinimized:!1}),actions:{togglePanel(){this.isPanelMinimized=!this.isPanelMinimized},setPanelMinimized(a){this.isPanelMinimized=a}}}),yr=Zt("viewer",{state:()=>({zoom:1.2,center:{x:.5,y:.3}}),actions:{setViewport(a,f){this.zoom=a,this.center=f}}});function De(a,f){if(!f)return!0;if(!a)return!1;const h=a.startskog,c=a.startskogExclusive===!0;return Array.isArray(h)?h.includes(f):typeof h=="string"?h==="all"||h==="alla"?!0:!c&&a.framework==="trakthygge"&&(h==="naturskog"||h==="produktionsskog_")?f==="naturskog"||f==="produktionsskog_":h===f:!0}const hr={name:"OpenSeadragonViewer",emits:["annotationClicked","viewportChanged","opened"],props:{currentFramework:{type:Object,required:!0},currentTime:{type:String,required:!0},currentStartskog:{type:Object,required:!0},retentionVisible:{type:Boolean,default:!1},fullscreenLayout:{type:Boolean,default:!1},comparisonMode:{type:Boolean,default:!1},frameworkLabel:{type:String,default:""},timeLabel:{type:String,default:""},layoutMode:{type:String,default:"slider"},globalOpacity:{type:Number,default:void 0},sliderPosition:{type:String,default:"left"},dziUrl:{type:String,required:!0},allowPan:{type:Boolean,default:!0},annotations:{type:Array,default:()=>[]},preloadDziUrls:{type:Array,default:()=>[]},overlayDziUrl:{type:String,default:null},kanteffektVisible:{type:Boolean,default:!1},oldKanteffektVisible:{type:Boolean,default:!0},rottackeSkarmtradVisible:{type:Boolean,default:!1},rottackeBladningVisible:{type:Boolean,default:!1},seedTreeVisible:{type:Boolean,default:!1},devSaveClicks:{type:Boolean,default:!1},showOverlayLabels:{type:Boolean,default:!0},showNaturvardCounter:{type:Boolean,default:!1},smaplantorVisible:{type:Boolean,default:!1},hogstubbarVisible:{type:Boolean,default:!1},naturvardsarterVisible:{type:Boolean,default:!1},tradplantorVisible:{type:Boolean,default:!1},retentionPoints:{type:Array,default:()=>[]},seedTreePoints:{type:Array,default:()=>[]},smaplantorPoints:{type:Array,default:()=>[]},hogstubbarPoints:{type:Array,default:()=>[]},naturvardsarterPoints:{type:Array,default:()=>[]},kanteffektFeatures:{type:Array,default:()=>[]}},setup(a,{emit:f,expose:h}){const c=N(()=>{const e=At(a.currentFramework);if(e==null)return null;if(typeof e=="string")return e;if(typeof e=="object"){if(Object.prototype.hasOwnProperty.call(e,"value")&&typeof e.value=="string")return e.value;if(Object.prototype.hasOwnProperty.call(e,"framework")&&typeof e.framework=="string")return e.framework}return null}),O=N(()=>{const e=At(a.currentStartskog);return e==null?null:typeof e=="string"?e:typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"value")&&typeof e.value=="string"?e.value:null}),q=N(()=>Array.isArray(a.retentionPoints)?a.retentionPoints:[]),G=N(()=>Array.isArray(a.seedTreePoints)?a.seedTreePoints:[]),E=N(()=>Array.isArray(a.smaplantorPoints)?a.smaplantorPoints:[]),D=N(()=>Array.isArray(a.hogstubbarPoints)?a.hogstubbarPoints:[]),_=N(()=>Array.isArray(a.naturvardsarterPoints)?a.naturvardsarterPoints:[]),Y=N(()=>{if(!a.showNaturvardCounter||!a.naturvardsarterVisible)return null;const e=_.value;if(!Array.isArray(e))return null;const r=c.value,o=O.value,n=a.currentTime;if(!n)return{total:0,gained:0,lost:0};const l=M=>M?M==="myc-7.1"?"myc-7":M:null,s=M=>!(!M||r&&!be(M.framework,r)||o&&M.startskog&&!be(M.startskog,o)),u=(M,L)=>s(M)?L?M.time?K(M.time,L):!1:!0:!1,v=M=>{const L=new Set;return e.forEach(B=>{if(!u(B,M)||B.removed)return;const S=l(B.id);S&&L.add(S)}),L},d=(()=>{const M=new Map;e.forEach(P=>{if(!s(P))return;const b=typeof P.time=="string"?P.time:null;if(!b)return;const z=b.toLowerCase();M.has(z)||M.set(z,b)});const L=Array.from(M.values());(()=>{L.some(b=>b.toLowerCase()===n.toLowerCase())||L.push(n)})();const S=P=>{const b=Ya.findIndex(z=>z.toLowerCase()===P.toLowerCase());return b===-1?Number.MAX_SAFE_INTEGER:b};return L.sort((P,b)=>S(P)-S(b)),L})(),y=n.toLowerCase(),m=d.findIndex(M=>M.toLowerCase()===y),w=m>0?d[m-1]:null,g=v(n),k=w?v(w):new Set;let I=0,X=0;return k.forEach(M=>{g.has(M)||(I+=1)}),g.forEach(M=>{k.has(M)||(X+=1)}),w||(I=0,X=0),{total:g.size,gained:X,lost:I}}),$=N(()=>Array.isArray(a.kanteffektFeatures)?a.kanteffektFeatures:[]),ue={xMin:.2675,xMax:.7325,yMin:.1393,yMax:.4143},oe=(e,r)=>{const o=e.xMax-e.xMin,n=e.yMax-e.yMin;return r.map(([l,s])=>[e.xMin+l*o,e.yMin+s*n])},Z=[[1,0],[1,1],[0,1],[0,0]],se=[[.973713,.023474],[.673993,.023474],[.673993,.052365],[.027796,.052365],[.027796,.955941],[.973713,.955941]],me=W([]),_e=W([]),ce=W([]);Ze("matsvamp-skogsbruk",()=>Ke("matsvampSkogsbruk").first()).then(({data:e})=>{const r=e.value;me.value=Array.isArray(r?.entries)?r.entries:[]}),Ze("signal-rodlistade-skogsbruk",()=>Ke("signalRodlistadeSkogsbruk").first()).then(({data:e})=>{const r=e.value;_e.value=Array.isArray(r?.entries)?r.entries:[]}),Ze("total-svampar-skogsbruk",()=>Ke("totalSvamparSkogsbruk").first()).then(({data:e})=>{const r=e.value;ce.value=Array.isArray(r?.entries)?r.entries:[]});const ve=W([]);Rt(async()=>{try{const r=await(await fetch("/api/savedclicks")).json();ve.value=r.clicks||[]}catch(e){console.error("Failed fetching saved clicks:",e)}}),Ua();const fe=yr(),i=W(null),Ve=W(!1),T=W(null),J=W([]),F=W(null),Q=W(!1);let ge=null,ae=null;const C=W({visible:!1,top:0,left:0,width:0,height:0}),re=N(()=>({position:"absolute",top:C.value.top+"px",left:C.value.left+"px",width:C.value.width+"px",height:C.value.height+"px"})),K=(e,r)=>e==="alla"?!0:Array.isArray(e)?e.includes("alla")||e.includes(r):e===r,be=(e,r)=>e==="alla"?!0:Array.isArray(e)?e.includes("alla")||e.includes(r):e===r,V=document.createElement("canvas");V.setAttribute("willReadFrequently","true");let t=null,xe=null;function ea(){V.style.position="absolute",V.style.top="0",V.style.left="0",V.style.width="100%",V.style.height="100%",V.style.pointerEvents="none",V.style.zIndex="10",T.value.appendChild(V),V.width=T.value.clientWidth,V.height=T.value.clientHeight,t=V.getContext("2d"),xe&&xe.disconnect(),xe=new ResizeObserver(gt),xe.observe(T.value);try{i.value?.addHandler?.("animation",()=>{R()}),i.value?.addHandler?.("animation-finish",()=>{R()}),i.value?.addHandler?.("viewport-change",()=>{R()})}catch{}}const ta="M9.075 16.25L12 14.475l2.925 1.775l-.775-3.325l2.6-2.25l-3.425-.275L12 7.25l-1.325 3.15l-3.425.275l2.6 2.25zM12 23.3L8.65 20H4v-4.65L.7 12L4 8.65V4h4.65L12 .7L15.35 4H20v4.65L23.3 12L20 15.35V20h-4.65zm0-2.8l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18h3.5zm0-8.5",aa="M9.075 16.25L12 14.475l2.925 1.775l-.775-3.325l2.6-2.25l-3.425-.275L12 7.25l-1.325 3.15l-3.425.275l2.6 2.25zM12 23.3L8.65 20H4v-4.65L.7 12L4 8.65V4h4.65L12 .7L15.35 4H20v4.65L23.3 12L20 15.35V20h-4.65z";function vt(e,r,o,n){e.save();const l=n*2.5/24;e.translate(r,o),e.scale(l,l),e.translate(-12,-12);const s=new Path2D(aa);e.fillStyle="rgb(20,184,166)",e.fill(s,"nonzero");const u=new Path2D(ta);e.fillStyle="white",e.fill(u,"evenodd"),e.restore()}const ra="m9.8 17l-3.9-5.4L20 2l2 3v3h-3v3h-3v3h-3v3m-3.3 1.7l-.5 2.8l-1.6 1.2c-.9.6-2.1.4-2.8-.5l-3.5-4.9c-.6-.9-.4-2.1.5-2.8l3.3-2.3zM4.6 15L3 16.1L6.5 21l1.6-1.2z",na="M5.874 5.89A8.13 8.13 0 0 0 4 11.1a.9.9 0 0 0 .9.9H12m4 0h3.1a.9.9 0 0 0 .9-.9C20 6.626 16.418 3 12 3c-1.43 0-2.774.38-3.936 1.047M10 12v7a2 2 0 1 0 4 0v-5M3 3l18 18",ia="M8 11a1 1 0 1 1 0-2a1 1 0 0 1 0 2m0 2.5a3.5 3.5 0 1 0 0-7a3.5 3.5 0 0 0 0 7M22.999 7c-4.301 0-7.833 3.407-7.998 7.702a1.25 1.25 0 0 0 2.498.096A5.51 5.51 0 0 1 23 9.5a5.501 5.501 0 0 1 .001 11H5.25a1.25 1.25 0 1 0 0 2.5H23a8 8 0 1 0-.001-16m14.988 11.5a6.035 6.035 0 0 0-5.854 4.562l-.096.385a1.25 1.25 0 0 0 2.426.606l.096-.384A3.535 3.535 0 0 1 37.987 21a3.51 3.51 0 0 1 3.513 3.5A3.5 3.5 0 0 1 38 28H5.25a1.25 1.25 0 1 0 0 2.5H30c1.642 0 3 1.368 3 3.04c0 1.628-1.323 2.96-2.922 2.96a2.92 2.92 0 0 1-2.613-1.615l-.097-.194a1.25 1.25 0 1 0-2.236 1.118l.097.194A5.42 5.42 0 0 0 30.079 39c3.009 0 5.421-2.481 5.421-5.46a5.54 5.54 0 0 0-.908-3.04H38a6 6 0 0 0 6-6c0-3.318-2.704-6-6.013-6M19 39a1 1 0 1 0-2 0a1 1 0 0 0 2 0m2.5 0a3.5 3.5 0 1 1-7 0a3.5 3.5 0 0 1 7 0M40 12a1 1 0 1 0-2 0a1 1 0 0 0 2 0m2.5 0a3.5 3.5 0 1 1-7 0a3.5 3.5 0 0 1 7 0",oa="M5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 0 2H6a1 1 0 0 1-1-1m5 0a1 1 0 0 1 1-1h9a1 1 0 1 1 0 2h-9a1 1 0 0 1-1-1M3 9a1 1 0 0 1 1-1h9a1 1 0 1 1 0 2H4a1 1 0 0 1-1-1m12 0a1 1 0 0 1 1-1h2a1 1 0 1 1 0 2h-2a1 1 0 0 1-1-1M5 14a1 1 0 0 1 1-1h2a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1m5 0a1 1 0 0 1 1-1h9a1 1 0 1 1 0 2h-9a1 1 0 0 1-1-1m-7 5a1 1 0 0 1 1-1h9a1 1 0 1 1 0 2H4a1 1 0 0 1-1-1m12 0a1 1 0 0 1 1-1h2a1 1 0 1 1 0 2h-2a1 1 0 0 1-1-1";function Oe(e,r,o,n,l,s,u=24,v=!1,d=0){if(typeof Path2D>"u")return;const y=new Path2D(r);e.save(),e.translate(o,n),d&&e.rotate(d);const m=l/u;e.scale(m,m),v&&e.scale(-1,1),e.translate(-u/2,-u/2),e.fillStyle=s,e.fill(y),e.restore()}const ft="M5 6.41L6.41 5L17 15.59V9h2v10H9v-2h6.59z";function sa(e,r,o,n,l,s,u=24){if(typeof Path2D>"u")return;const v=new Path2D(r);e.save(),e.translate(o,n);const d=l/u;e.scale(d,d),e.translate(-u/2,-u/2),e.strokeStyle=s,e.lineWidth=2,e.lineCap="round",e.lineJoin="round",e.stroke(v),e.restore()}function Ae(e,r,o,n){e.save(),e.beginPath(),e.arc(r,o,n,0,2*Math.PI),e.fillStyle="#ffffff",e.shadowColor="rgba(15, 23, 42, 0.25)",e.shadowBlur=Math.max(4,n*.6),e.shadowOffsetX=0,e.shadowOffsetY=Math.max(1,n*.25),e.fill(),e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.lineWidth=Math.max(1,n*.05),e.strokeStyle="#f9f6f3",e.stroke(),e.restore()}function gt(){V.width=T.value.clientWidth,V.height=T.value.clientHeight,R()}const Re=document.createElement("canvas");Re.setAttribute("willReadFrequently","true"),Re.width=Re.height=8;const ke=Re.getContext("2d");ke.fillStyle="rgba(255,255,255,0.3)",ke.fillRect(0,0,8,8),ke.strokeStyle="rgba(115,115,115,0.3)",ke.lineWidth=4,ke.beginPath(),ke.moveTo(0,8),ke.lineTo(8,0),ke.stroke();function R(){if(!i.value||!t)return;if(t.createPattern(Re,"repeat"),t.clearRect(0,0,V.width,V.height),C.value.visible=!1,a.retentionVisible){const n=q.value,l=c.value,s=O.value;n.forEach(u=>{if(!u||l&&u.framework&&u.framework!=="alla"&&u.framework!==l||!K(u.time,a.currentTime)||!De(u,s))return;const v=new x.Point(u.x,u.y),d=i.value.viewport.pixelFromPoint(v,!0),y=.03/2,m=i.value.viewport.pixelFromPoint(new x.Point(u.x+y,u.y),!0),w=Math.abs(m.x-d.x),g=t.createRadialGradient(d.x,d.y,0,d.x,d.y,w);g.addColorStop(0,"rgba(255,255,255,0.55)"),g.addColorStop(1,"rgba(255,255,255,0.85)"),t.save(),t.beginPath(),t.arc(d.x,d.y,w,0,2*Math.PI),t.closePath(),t.fillStyle=g,t.fill(),t.restore(),t.beginPath(),t.arc(d.x,d.y,w,0,2*Math.PI),t.strokeStyle="rgba(255,255,255,0)",t.lineWidth=2,t.stroke()})}if(a.tradplantorVisible&&c.value==="trakthygge"&&a.currentTime==="20 år"){const u=i.value.viewport.pixelFromPoint(new x.Point(.2671,.1383),!0),v=i.value.viewport.pixelFromPoint(new x.Point(.7312,.4152),!0),d=Math.min(u.x,v.x),y=Math.max(u.x,v.x),m=Math.min(u.y,v.y),w=Math.max(u.y,v.y);t.save(),t.beginPath(),t.rect(d,m,y-d,w-m),t.clip();const g=Math.abs(.7312-.2671),k=Math.abs(.4152-.1383),I=.013,X=Math.max(1,Math.round(g/I)),M=Math.max(1,Math.round(k/I)),L=g/X,B=k/M,S=Math.min(L,B)*.1;t.beginPath();for(let P=0;P<M;P++){const b=.1383+(P+.5)*B;for(let z=0;z<X;z++){const j=.2671+(z+.5)*L,H=i.value.viewport.pixelFromPoint(new x.Point(j,b),!0),ee=i.value.viewport.pixelFromPoint(new x.Point(j+S,b),!0),he=Math.abs(ee.x-H.x);!isFinite(he)||he<=.2||(t.moveTo(H.x+he,H.y),t.arc(H.x,H.y,he,0,Math.PI*2))}}t.fillStyle="rgba(255,255,255,0.85)",t.fill(),t.restore()}if(a.smaplantorVisible&&E.value.length){const o=E.value,n=c.value,l=O.value;o.forEach(s=>{if(!s||n&&s.framework&&s.framework!==n||!De(s,l)||s.time&&!K(s.time,a.currentTime))return;const u=new x.Point(s.x,s.y),v=i.value.viewport.pixelFromPoint(u,!0),d=5e-4,y=i.value.viewport.pixelFromPoint(new x.Point(s.x+d,s.y),!0),m=Math.abs(y.x-v.x);t.save(),t.beginPath(),t.arc(v.x,v.y,m,0,2*Math.PI),t.fillStyle="rgba(255, 255, 255, 0.95)",t.fill(),t.lineWidth=1,t.strokeStyle="rgba(255,255,255,1)",t.stroke(),t.restore()})}if(a.hogstubbarVisible&&D.value.length){const o=D.value,n=c.value,l=O.value;o.forEach(s=>{if(!s||n&&s.framework&&s.framework!==n||!De(s,l)||s.time&&!K(s.time,a.currentTime))return;const u=new x.Point(s.x,s.y),v=i.value.viewport.pixelFromPoint(u,!0),d=.003,y=i.value.viewport.pixelFromPoint(new x.Point(s.x+d,s.y),!0),m=Math.abs(y.x-v.x);t.save(),t.beginPath(),t.arc(v.x,v.y,m,0,2*Math.PI),t.fillStyle="rgba(0, 0, 0, 0.55)",t.fill(),t.lineWidth=2,t.strokeStyle="rgba(255,255,255,0.6)",t.stroke(),t.restore()})}if(a.seedTreeVisible){const n=G.value,l=c.value,s=O.value;n.forEach(u=>{if(l&&u.framework!==l||!K(u.time,a.currentTime)||!De(u,s))return;const v=new x.Point(u.x,u.y),d=i.value.viewport.pixelFromPoint(v,!0),y=.03/2,m=i.value.viewport.pixelFromPoint(new x.Point(u.x+y,u.y),!0),w=Math.abs(m.x-d.x),g=t.createRadialGradient(d.x,d.y,0,d.x,d.y,w);g.addColorStop(0,"rgba(255,255,255,0.55)"),g.addColorStop(1,"rgba(255,255,255,0.85)"),t.save(),t.beginPath(),t.arc(d.x,d.y,w,0,Math.PI*2),t.closePath(),t.fillStyle=g,t.fill(),t.restore(),t.beginPath(),t.arc(d.x,d.y,w,0,Math.PI*2),t.strokeStyle="rgba(255,255,255,0)",t.lineWidth=2,t.stroke()})}const e=c.value,r=$.value.filter(o=>(!e||o.framework===e)&&(Array.isArray(o.start)?o.start.includes(a.currentTime):o.start===a.currentTime));if(a.kanteffektVisible&&r.filter(o=>o.shape==="polygon").forEach(o=>{let n=1;if(o.framework==="trakthygge"&&(n={efter:1,"20 år":1,"50 år":.5,"80 år":.5}[a.currentTime]??.5),o.framework==="skärmträd"&&(n={"10 år":1,"20 år":1,"50 år":.45,"80 år":.45}[a.currentTime]??.5),!a.oldKanteffektVisible&&n===.5)return;const l=n,s=oe(ue,Z).map(([v,d])=>i.value.viewport.pixelFromPoint(new x.Point(v,d),!0)),u=oe(ue,se).map(([v,d])=>i.value.viewport.pixelFromPoint(new x.Point(v,d),!0));if(a.kanteffektVisible){t.save(),t.beginPath(),s.forEach((g,k)=>k===0?t.moveTo(g.x,g.y):t.lineTo(g.x,g.y)),t.closePath(),t.moveTo(u[0].x,u[0].y),u.forEach((g,k)=>t.lineTo(g.x,g.y)),t.closePath(),t.clip("evenodd"),t.globalAlpha=l,t.translate(0,0),t.rotate(-45*Math.PI/180);const v=4,d=V.width,y=V.height,m=Math.hypot(d,y),w=Math.ceil((m+v*2)/(v*2));for(let g=-w;g<=w;g++){const k=g*v*2;t.fillStyle="rgba(255,255,255,1)",t.fillRect(k,-m,v,m*2),t.fillStyle="rgba(115,115,115,0.5)",t.fillRect(k+v,-m,v,m*2)}t.restore(),t.save(),t.globalAlpha=l,t.beginPath(),s.forEach((g,k)=>k===0?t.moveTo(g.x,g.y):t.lineTo(g.x,g.y)),t.closePath(),t.moveTo(u[0].x,u[0].y),u.forEach((g,k)=>t.lineTo(g.x,g.y)),t.closePath(),t.strokeStyle="rgba(255,255,255,0.8)",t.lineWidth=1,t.stroke(),t.restore()}}),a.kanteffektVisible&&r.filter(o=>o.shape==="squareHole").forEach(o=>{const n=o.x,l=new x.Point(n,o.y),s=i.value.viewport.pixelFromPoint(l,!0),u=o.size/2,v=o.holeSize/2,d=i.value.viewport.pixelFromPoint(new x.Point(n+u,o.y),!0),y=Math.abs(d.x-s.x),m=y*2,w=i.value.viewport.pixelFromPoint(new x.Point(n+v,o.y),!0),g=Math.abs(w.x-s.x);let k=null;const I=typeof o.id=="string"?o.id.match(/ke-luckh-(\d+)/):null;I&&(k=parseInt(I[1],10));const X=[2,4,8,11,14],M=[1,3,7,10,13],L=[5,6,9,12,15],B=a.currentTime;let S=.5;if(k!=null){let b=.5;if(X.includes(k)?b={efter:1,"20 år":1,"50 år":.5,"80 år":.5}[B]??.5:M.includes(k)?b={"50 år":1,"80 år":.5}[B]??.5:L.includes(k)&&(b={"80 år":1}[B]??.5),!a.oldKanteffektVisible&&b===.5)return;S=b}if(a.kanteffektVisible){t.save(),t.globalAlpha=S,t.beginPath(),t.rect(s.x-y,s.y-y,m,m),t.rect(s.x-g,s.y-g,g*2,g*2),t.clip("evenodd"),t.translate(s.x,s.y),t.rotate(-45*Math.PI/180);const b=4,z=Math.hypot(m,m),j=Math.ceil((z+b*2)/(b*2));for(let H=-j;H<=j;H++){const ee=H*b*2;t.fillStyle="rgba(255,255,255,1)",t.fillRect(ee,-z,b,z*2),t.fillStyle="rgba(115,115,115,0.8)",t.fillRect(ee+b,-z,b,z*2)}t.restore(),t.save(),t.globalAlpha=S,t.beginPath(),t.rect(s.x-y,s.y-y,m,m),t.strokeStyle="rgba(255,255,255,1)",t.lineWidth=1,t.stroke(),t.restore()}let P=null;if(k!=null&&(X.includes(k)||M.includes(k)||L.includes(k))&&(P=""),P){const b=Math.max(9,Math.min(14,m*.12)),z=s.x-y,j=s.y-y,H=Math.max(3,b*.3),ee=Math.max(2,b*.2);t.save(),t.globalAlpha=1,t.font=`${b}px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif`,t.textAlign="left",t.textBaseline="top";const Ia=t.measureText(P).width,La=b*1.2,zt=z+H,_t=j+ee,Ea=Ia+H*2,Fa=La+ee*2;t.fillStyle="rgba(0,0,0,0.85)",t.fillRect(zt-H,_t-ee,Ea,Fa),t.fillStyle="white",t.fillText(P,zt,_t),t.restore()}t.globalAlpha=1}),a.rottackeSkarmtradVisible||a.rottackeBladningVisible){const o=c.value,n=a.currentTime,l=o==="skärmträd"||o==="skarmtrad",s=o==="blädning"||o==="bladning",u=a.rottackeSkarmtradVisible&&l&&n==="efter",v=a.rottackeBladningVisible&&s&&(n==="efter"||n==="20 år"||n==="50 år"||n==="80 år");if(u||v){const d={x:.2675,y:.1393,width:.465,height:.275},y=i.value.viewport.pixelFromPoint(new x.Point(d.x,d.y),!0),m=i.value.viewport.pixelFromPoint(new x.Point(d.x+d.width,d.y+d.height),!0),w=m.x-y.x,g=m.y-y.y;a.rottackeBladningVisible&&s&&n==="efter"&&(C.value={visible:!0,top:Math.min(y.y,m.y),left:Math.min(y.x,m.x),width:Math.abs(w),height:Math.abs(g)}),t.save(),t.beginPath(),t.rect(y.x,y.y,w,g),t.clip(),t.translate(y.x+w/2,y.y+g/2),t.rotate(-45*Math.PI/180);const k=4,I=Math.hypot(w,g),X=Math.ceil((I+k*2)/(k*2));for(let M=-X;M<=X;M++){const L=M*k*2;t.fillStyle="rgba(255,255,255,0.7)",t.fillRect(L,-I,k,I*2),t.fillStyle="rgba(115,115,115,0.5)",t.fillRect(L+k,-I,k,I*2)}t.restore(),t.save(),t.strokeStyle="rgba(255,255,255,0.8)",t.lineWidth=2,t.strokeRect(y.x,y.y,w,g),t.restore()}}if(i.value&&ye.length&&(ye.forEach(o=>{try{i.value.removeOverlay(o)}catch{}}),ye=[]),a.naturvardsarterVisible&&_.value.length){const o=_.value,n=c.value,l=O.value,s=[...o].sort((d,y)=>{const m=w=>w?.id?w.id==="myc-7"?1:w.id==="myc-7.1"?2:0:0;return m(d)-m(y)}),u=s.some(d=>!(!d||d.id!=="myc-7.1"||n&&!be(d.framework,n)||l&&d.startskog&&d.startskog!==l||d.time&&!K(d.time,a.currentTime)||d.removed)),v=[];s.forEach(d=>{if(!d||n&&!be(d.framework,n)||l&&d.startskog&&d.startskog!==l||d.time&&!K(d.time,a.currentTime))return;const y=new x.Point(d.x,d.y),m=i.value.viewport.pixelFromPoint(y,!0),w=.008,g=i.value.viewport.pixelFromPoint(new x.Point(d.x+w,d.y),!0),k=Math.abs(g.x-m.x),I=!!d.removed,X=d.id==="myc-7",M=d.id==="myc-7.1";let L="Naturvårdsart som fanns i beståndet från början";if(m.x,m.y,I){if(t.save(),t.globalAlpha=X?.4:.5,vt(t,m.x,m.y,k),t.restore(),!X){const S=k*1.2;t.save(),t.strokeStyle="rgba(239,68,68,0.9)",t.lineWidth=Math.max(1,k*.25),t.beginPath(),t.moveTo(m.x-S,m.y-S),t.lineTo(m.x+S,m.y+S),t.moveTo(m.x-S,m.y+S),t.lineTo(m.x+S,m.y-S),t.stroke(),t.restore();const P=k*.7,b=k*.9,z=m.x+b,j=m.y-b;Ae(t,z,j,P);const H=P*1.5;d.id==="myc-2"?sa(t,na,z,j,H,"#5a3f34"):Oe(t,ra,z,j,H,"#5a3f34"),L=d.id==="myc-2"?"Naturvårdsart som dött av ålder eller blivit utkonkurerad av annan art":"Naturvårdsart som försvann vid avverkning"}}else if(vt(t,m.x,m.y,k),M){const S=k*.7,P=k*.9,b=m.x+P,z=m.y-P;Ae(t,b,z,S);const j=S*1.5;Oe(t,ft,b,z,j,"#5a3f34"),L="Arten har förflyttat sig själv"}else if(d.id==="myc-11"||d.id==="myc-12"){const S=k*.7,P=k*.9,b=m.x+P,z=m.y-P,j=S*1.3;if(d.id==="myc-11"){const H=S*1.3,ee=b-H/2,he=b+H/1.5;Ae(t,ee,z,S),Oe(t,oa,ee,z,j,"#5a3f34",24),Ae(t,he,z,S),Oe(t,ft,he,z,j,"#5a3f34",24,!1,Math.PI),L="Naturvårdsart som etablerats med spridda sporer"}else Ae(t,b,z,S),Oe(t,ia,b,z,j,"#5a3f34",48,!0),L="Naturvårdsart som etablerats med spridda sporer"}if(a.showOverlayLabels&&d.id){t.save(),t.font=`${Math.max(6,k*1.1).toFixed(0)}px "Segoe UI", system-ui, sans-serif`,I?(t.fillStyle="rgba(239, 68, 68, 0.9)",t.strokeStyle="rgba(255, 255, 255, 0.85)"):(t.fillStyle="rgba(17, 24, 39, 0.85)",t.strokeStyle="rgba(255, 255, 255, 0.8)"),t.lineWidth=Math.max(1,k*.15);const S=m.x+k*-1,P=m.y-k*1.4;t.strokeText(d.id,S,P),t.fillText(d.id,S,P),t.restore()}let B=Math.max(k*1.6,18);if(I&&!X||M||d.id==="myc-11"||d.id==="myc-12"){const S=k*.7,P=k*.9,b=Math.hypot(P,P);B=Math.max(B,b+S)}if(!(d.id==="myc-7"&&u)){try{const S=i.value.viewport.imageToViewportCoordinates(d.x,d.y),P=i.value.viewport.deltaPointsFromPixels(new x.Point(B*2,B*2),!0),b=new x.Rect(S.x-P.x/2,S.y-P.y/2,Math.max(P.x,1e-8),Math.max(P.y,1e-8)),z=document.createElement("div");z.className="clickable-overlay";const j=`nv-click-${d.id}-${Math.round(m.x)}-${Math.round(m.y)}`;z.id=j,i.value.addOverlay({element:z,location:b,id:j}),ye.push(j)}catch{}v.push({x:m.x,y:m.y,radius:B,message:L,worldX:d.x,worldY:d.y})}}),J.value=v,v.length||(F.value=null,Q.value=!1)}else J.value=[],F.value=null,Q.value=!1,i.value&&ye.length&&(ye.forEach(o=>{try{i.value.removeOverlay(o)}catch{}}),ye=[]);if(Q.value&&F.value&&F.value.anchorWorldX!=null)try{const o=new x.Point(F.value.anchorWorldX,F.value.anchorWorldY),n=i.value.viewport.pixelFromPoint(o,!0),l=T.value.clientWidth,s=T.value.clientHeight,u=F.value.offsetX??12,v=F.value.offsetY??-28,d=Math.min(Math.max(n.x+u,0),l-10),y=Math.min(Math.max(n.y+v,0),s-10);F.value={...F.value,left:d,top:y}}catch{}if(kt.staticOverlayVisible){const{xMin:o,yMin:n,xMax:l,yMax:s}=ue,u=i.value.viewport.pixelFromPoint(new x.Point(o,n),!0),v=i.value.viewport.pixelFromPoint(new x.Point(l,s),!0);t.strokeStyle="white",t.lineWidth=2,t.strokeRect(u.x,u.y,v.x-u.x,v.y-u.y)}if(ve.value.length){const o=c.value,n=O.value;ve.value.forEach(l=>{if(o&&l.framework&&l.framework!==o||n&&l.startskog&&l.startskog!==n||l.time&&!K(l.time,a.currentTime))return;const s=new x.Point(l.x,l.y),u=i.value.viewport.pixelFromPoint(s,!0),v=5e-4,d=i.value.viewport.pixelFromPoint(new x.Point(l.x+v,l.y),!0),y=Math.abs(d.x-u.x);t.save(),t.beginPath(),t.arc(u.x,u.y,y,0,2*Math.PI),t.fillStyle="rgba(255, 255, 255, 0.95)",t.fill(),t.lineWidth=1,t.strokeStyle="rgba(255, 255, 255, 1)",t.stroke(),t.restore()})}}const kt=Za();A(()=>a.retentionVisible,()=>{t&&R()}),A(()=>a.kanteffektVisible,()=>{t&&R()}),A(()=>kt.staticOverlayVisible,()=>{t&&R()}),A(()=>a.oldKanteffektVisible,()=>{t&&R()}),A(()=>a.currentTime,()=>{t&&R()}),A(()=>a.currentFramework,()=>{t&&R()}),A(c,()=>{t&&R()}),A(()=>a.rottackeSkarmtradVisible,()=>{t&&R()}),A(()=>a.rottackeBladningVisible,()=>{t&&R()}),A(()=>a.seedTreeVisible,()=>{t&&R()}),A(()=>a.devSaveClicks,()=>{t&&R()}),A(()=>a.showOverlayLabels,()=>{t&&R()}),A(()=>a.smaplantorVisible,()=>{t&&R()}),A(()=>a.hogstubbarVisible,()=>{t&&R()}),A(()=>a.naturvardsarterVisible,()=>{t&&R()}),A(()=>a.naturvardsarterVisible,e=>{e||(F.value=null,J.value=[],Q.value=!1)}),A(()=>a.tradplantorVisible,()=>{t&&R()}),A(O,()=>{t&&R()}),A(()=>a.retentionPoints,()=>{t&&R()},{deep:!0}),A(()=>a.seedTreePoints,()=>{t&&R()},{deep:!0}),A(()=>a.smaplantorPoints,()=>{t&&R()},{deep:!0}),A(()=>a.hogstubbarPoints,()=>{t&&R()},{deep:!0}),A(()=>a.naturvardsarterPoints,()=>{t&&R()},{deep:!0}),A(()=>a.kanteffektFeatures,()=>{t&&R()},{deep:!0});const la=N(()=>"openseadragon-viewer-"+Math.random().toString(36).substr(2,9));let x=null;const Ce=W(null),we=W(null),Ge=W(null);let Be=0,Ie=0;const le=W(null),We=new Set,Le=new Set,Te=[];let Me=!1;function ne(e){if(e){try{i.value&&i.value.world&&i.value.world.getIndexOfItem(e)!==-1&&i.value.world.removeItem(e)}catch(r){console.warn("[OSD] failed to remove tiled image",r)}if(typeof e.destroy=="function")try{e.destroy()}catch(r){console.warn("[OSD] failed to destroy tiled image",r)}}}function je(e,r,o=!1){if(!e){r();return}let n=!1,l;const s=()=>{l&&clearTimeout(l),e.removeHandler("fully-loaded",v),e.removeHandler("tile-drawn",d)},u=()=>{n||(n=!0,s(),r())},v=()=>u(),d=()=>{(!o||!e.getFullyLoaded||e.getFullyLoaded())&&u()};if(!o){e.addHandler("tile-drawn",d),l=setTimeout(u,500);return}if(typeof e.getFullyLoaded=="function"&&e.getFullyLoaded()){u();return}e.addHandler("fully-loaded",v),e.addHandler("tile-drawn",d),l=setTimeout(u,2e3)}function da(e=[]){if(!Array.isArray(e))return;const r=a.dziUrl,o=a.overlayDziUrl;for(const n of e)typeof n!="string"||!n||We.has(n)||Le.has(n)||n===r||n===o||(Le.add(n),Te.push(n));Ue()}function Ue(){if(Me||!i.value||!Te.length)return;Me=!0;const e=()=>{if(!i.value){Me=!1;return}const r=Te.shift();if(!r){Me=!1;return}Le.delete(r),ua(r).finally(()=>{Te.length?e():Me=!1})};e()}function ua(e){return new Promise(r=>{if(!e||We.has(e)){r();return}if(!i.value){Te.unshift(e),Le.add(e),r();return}i.value.addTiledImage({tileSource:e,crossOriginPolicy:"Anonymous",ajaxWithCredentials:!1,opacity:0,preload:!0,index:i.value.world.getItemCount(),success:o=>{const n=o.item;je(n,()=>{We.add(e),ne(n),r()},!0)},error:o=>{console.warn("[OSD] preload failed for",e,o),r()}})})}function yt(e){if(!i.value)return;const r=we.value,o=++Ie;if(!e){we.value=null,ne(r);return}i.value.addTiledImage({tileSource:e,crossOriginPolicy:"Anonymous",ajaxWithCredentials:!1,opacity:0,index:i.value.world.getItemCount(),success:n=>{const l=n.item;je(l,()=>{if(!i.value||o!==Ie){ne(l);return}we.value=l;const s=ze.value??1;typeof l.setOpacity=="function"&&l.setOpacity(s),r&&r!==l&&(typeof r.setOpacity=="function"&&r.setOpacity(0),setTimeout(()=>ne(r),200))})},error:n=>{console.error("[OSD] failed to load overlay tile source",n)}})}function ma(e,r){if(!i.value||!e)return Promise.resolve(null);const o=++Be,n=r?i.value.world.getIndexOfItem(r):void 0,l=typeof n=="number"&&n>=0?n:void 0;return new Promise(s=>{i.value.addTiledImage({tileSource:e,crossOriginPolicy:"Anonymous",ajaxWithCredentials:!1,opacity:0,index:l,success:u=>{const v=u.item;je(v,()=>{if(!i.value||o!==Be){ne(v),s(null);return}const d=r&&typeof r.getOpacity=="function"?r.getOpacity():1;s({item:v,targetOpacity:d})})},error:u=>{console.error("[OSD] failed to load tile source",u),s(null)}})})}function ca(e,r){if(!i.value||!e)return Promise.resolve(null);const o=++Ie,n=r?i.value.world.getIndexOfItem(r):i.value.world.getItemCount();return new Promise(l=>{i.value.addTiledImage({tileSource:e,crossOriginPolicy:"Anonymous",ajaxWithCredentials:!1,opacity:0,index:n,success:s=>{const u=s.item;je(u,()=>{if(!i.value||o!==Ie){ne(u),l(null);return}l({item:u,targetOpacity:ze.value??1})})},error:s=>{console.error("[OSD] failed to load overlay tile source",s),l(null)}})})}let Se=[],ye=[],Ee=[],Fe;function ht(){if(!i.value)return;Fe&&(i.value.removeHandler("animation",Fe),Fe=null),Ee.forEach(r=>r.destroy()),Ee=[],Se.forEach(({id:r,app:o})=>{o.unmount(),i.value.removeOverlay(r)}),Se=[];const e=T.value.querySelector("canvas");if(e){const r=e.getContext("webgl")||e.getContext("experimental-webgl");if(r){const o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}}xe&&(xe.disconnect(),xe=null),window.removeEventListener("resize",gt),V.parentNode&&V.parentNode.removeChild(V),i.value.clearOverlays(),ye=[],i.value.destroy(),i.value=null,Ce.value=null,we.value=null,Ge.value=null,Be=0,Ie=0,Te.length=0,Le.clear(),Me=!1}function va(e){if(!T.value)return;if(!a.naturvardsarterVisible||J.value.length===0){F.value=null,Q.value=!1;return}const r=T.value.getBoundingClientRect(),o=e.clientX-r.left,n=e.clientY-r.top;let l=null;for(const s of J.value){const u=o-s.x,v=n-s.y;if(u*u+v*v<=s.radius*s.radius){l=s;break}}if(l){const s=T.value.clientWidth,u=T.value.clientHeight,v=new x.Point(l.worldX??0,l.worldY??0),d=i.value.viewport.pixelFromPoint(v,!0),y=12,m=-28,w=Math.min(Math.max(d.x+y,0),s-10),g=Math.min(Math.max(d.y+m,0),u-10);F.value={message:l.message,left:w,top:g,anchorWorldX:l.worldX??null,anchorWorldY:l.worldY??null,offsetX:y,offsetY:m},Q.value=!0}else Q.value=!1,Je(()=>{F.value=null})}function pt(e){if(!T.value)return;if(!a.naturvardsarterVisible||J.value.length===0){T.value.style.cursor="default";return}const r=T.value.getBoundingClientRect(),o=e.clientX-r.left,n=e.clientY-r.top;let l=!1;for(const s of J.value){const u=o-s.x,v=n-s.y;if(u*u+v*v<=s.radius*s.radius){l=!0;break}}T.value.style.cursor=l?"pointer":"default"}function qe(){T.value&&(ge||(ge=e=>va(e),T.value.addEventListener("click",ge,{capture:!0,passive:!0}),T.value.addEventListener("mousemove",pt,{passive:!0})),ae||(ae=e=>{const r=T.value;r&&(r.contains(e.target)||(Q.value=!1,Je(()=>{F.value=null})))},document.addEventListener("click",ae,!0)))}function bt(){T.value&&ge&&T.value.removeEventListener("click",ge,{capture:!0}),T.value&&(T.value.removeEventListener("mousemove",pt),T.value.style.cursor="default"),ae&&document.removeEventListener("click",ae,!0),ge=null,ae=null,F.value=null,Q.value=!1}function fa(){qe()}const ga=lr(e=>St(e),100);A(()=>a.dziUrl,(e,r)=>{i.value&&e!==r&&(le.value=a.overlayDziUrl||null,ga(e))}),A(()=>a.overlayDziUrl,(e,r)=>{!i.value||e===r||le.value!==e&&yt(e)});const xt=kr(),ka=N(()=>xt.isPanelMinimized);function ya(){xt.togglePanel()}const Ne=N(()=>{let e;const r=a.currentTime.toLowerCase();return r.includes("innan")?e=0:r.includes("efter")?e=1:e=parseInt(a.currentTime),console.log("currentTime:",a.currentTime,"numericTime:",e),e}),wt=N(()=>Ne.value===0?-2:Ne.value),ha=N(()=>Ne.value===0?-4:Ne.value),pa=N(()=>{const e=c.value;if(!e)return"N/A";const r=ce.value.find(o=>o.artkategori==="total"&&o.frameworks===e&&Number(o.ålder)===ha.value);return r?r.klassning:"N/A"}),ba=N(()=>{const e=c.value,r=O.value;if(!e||!r)return"N/A";const o=me.value.find(n=>n.artkategori==="matsvamp"&&n.startskog===r&&n.frameworks===e&&Number(n.ålder)===wt.value);return o?o.klassning:"N/A"}),xa=N(()=>{const e=c.value,r=O.value;if(!e||!r)return"N/A";const o=_e.value.find(n=>n.artkategori==="rödlistade + signalarter"&&n.startskog===r&&n.frameworks===e&&Number(n.ålder)===wt.value);return o?o.klassning:"N/A"}),wa=N(()=>{const e=c.value,r=O.value;return!e||!a.currentTime||!r?null:gr.find(o=>o.atgard===e&&o.tid===a.currentTime&&o.startskog===r)}),Xe=W({x:0,y:0});function Pa(e){if(!T.value||!i.value||!x)return;const r=T.value.getBoundingClientRect(),o=e.clientX-r.left,n=e.clientY-r.top,l=new x.Point(o,n),s=i.value.viewport.pointFromPixel(l);Xe.value.x=s.x,Xe.value.y=s.y}function Ta(e){if(!a.devSaveClicks||!T.value||!i.value||!x)return;const r=T.value.getBoundingClientRect(),o=e.clientX-r.left,n=e.clientY-r.top,l=new x.Point(o,n),s=i.value.viewport.pointFromPixel(l),u=e.metaKey||e.ctrlKey,v=e.metaKey||e.shiftKey,d=u?"alla":a.currentTime,y=v?["naturskog","produktionsskog_"]:O.value,m=c.value;if(!m||!y)return;const w={framework:m,time:d,startskog:y,x:s.x,y:s.y,id:`click-${Date.now()}`};fetch("/api/savedclicks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)}).catch(g=>console.error("Failed saving click:",g)),ve.value.push(w)}const Pt=Kt();A(()=>Pt.selectedAnnotation,()=>{i.value&&Tt()});function Tt(){!i.value||!x||(Ee.forEach(e=>e.destroy()),Ee=[],Se.forEach(({id:e,app:r})=>{r.unmount(),i.value.removeOverlay(e)}),Se=[],a.annotations.forEach(e=>{if(!e.position)return;const r=document.createElement("div"),o=Pt.selectedAnnotation;o&&o.id===e.id?r.style.zIndex="6":r.style.zIndex="5";const n=It(fr,{annotation:e});n.mount(r);const l=new x.MouseTracker({element:r,clickHandler:()=>{f("annotationClicked",e)}});Ee.push(l);const s="annotation-"+e.id;r.id=s,i.value.addOverlay({element:r,location:new x.Point(e.position.x,e.position.y),placement:"BOTTOM",className:"clickable-overlay",checkResize:!1,id:p.id}),Se.push({id:s,app:n})}))}function Ma(e){if(!i.value||!x)return;const r=`popup-${e.id}`,o=document.createElement("div");o.id=r,o.style.pointerEvents="auto",i.value.addOverlay({element:o,location:new x.Point(e.position.x,e.position.y),className:"clickable-overlay",id:p.id,placement:"BOTTOM",checkResize:!1});const n=It(mr,{annotation:e});n.mount(o),Se.push({id:r,app:n})}async function Mt(){if(typeof window>"u"||i.value)return;const e=T.value;if(!e)return;const r=await Ct(()=>import("./B9rKIRhJ.js").then(l=>l.o),__vite__mapDeps([0,1]),import.meta.url),o=r.default||r;x=o,window.OpenSeadragon=x,await Ct(()=>import("./HoRGMImp.js"),[],import.meta.url);const n={element:e,crossOriginPolicy:"Anonymous",ajaxWithCredentials:!1,showNavigationControl:!1,imageLoaderLimit:4,maxImageCacheCount:50,visibilityRatio:1,homeFillsViewer:!0,minZoomLevel:1,wrapHorizontal:!1,wrapVertical:!1,constrainDuringPan:!0,panHorizontal:!0,panVertical:!0,homeFillsViewer:!0,animationTime:.5,defaultZoomLevel:a.layoutMode==="sideBySide"?null:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!1,dblClickToZoom:!0,clickTodrag:!1,pinchToZoom:!1},drawer:"canvas"};if(i.value=o(n),ea(),R(),i.value.addHandler("animation",R),i.value.addHandler("open",R),qe(),i.value.scalebar({type:x.ScalebarType.MAP,pixelsPerMeter:12,minWidth:"75px",location:x.ScalebarLocation.BOTTOM_LEFT,color:"white",fontColor:"white",backgroundColor:"rgba(0, 0, 0, 0.2)",barThickness:2}),fe.center){const{x:l,y:s}=fe.center;i.value.viewport.zoomTo(fe.zoom),i.value.viewport.panTo(new x.Point(l,s)),i.value.viewport.applyConstraints()}Fe=()=>{const l=i.value.viewport.getZoom(),s=i.value.viewport.getCenter();fe.setViewport(l,{x:s.x,y:s.y}),f("viewportChanged",{zoom:l,center:s})},i.value.addHandler("animation",Fe),le.value=a.overlayDziUrl||null,St(a.dziUrl),Ue()}async function St(e){if(!i.value||!e)return;const r=i.value.viewport.getZoom(),o=i.value.viewport.getCenter(),n=Ge.value,l=we.value,s=await ma(e,n);if(!s){le.value=null;return}let u=null;l&&le.value&&(u=await ca(le.value,l)),Ge.value=s.item,Ce.value=s.item,i.value.viewport.zoomTo(r,null,!0),i.value.viewport.panTo(o,!0),i.value.viewport.applyConstraints(),f("opened"),typeof s.item.setOpacity=="function"&&s.item.setOpacity(s.targetOpacity??1),u?.item?(we.value=u.item,typeof u.item.setOpacity=="function"&&u.item.setOpacity(u.targetOpacity??ze.value??1)):le.value&&yt(le.value);const v=250,d=[];n&&n!==s.item&&(typeof n.setOpacity=="function"?d.push(new Promise(y=>{let m=null;const w=n.getOpacity?.()??1,g=k=>{m===null&&(m=k);const I=Math.min((k-m)/v,1);n.setOpacity(w*(1-I)),I<1?requestAnimationFrame(g):y()};requestAnimationFrame(g)}).finally(()=>ne(n))):ne(n)),u?.item&&l&&l!==we.value&&(typeof l.setOpacity=="function"?d.push(new Promise(y=>{let m=null;const w=l.getOpacity?.()??1,g=k=>{m===null&&(m=k);const I=Math.min((k-m)/v,1);l.setOpacity(w*(1-I)),I<1?requestAnimationFrame(g):y()};requestAnimationFrame(g)}).finally(()=>ne(l))):ne(l)),await Promise.allSettled(d),le.value=null}const ze=W(a.globalOpacity!==void 0?a.globalOpacity:1);A(()=>a.naturvardsarterVisible,e=>{e?qe():(bt(),F.value=null,J.value=[],Q.value=!1,T.value&&(T.value.style.cursor="default"))}),A(()=>(a.preloadDziUrls||[]).join("|"),()=>{da(a.preloadDziUrls||[]),Ue()},{immediate:!0}),A(()=>a.globalOpacity,e=>{if(e!==void 0&&(ze.value=e,i.value&&a.overlayDziUrl)){const r=i.value.world.getItemCount();for(let o=0;o<r;o++){const n=i.value.world.getItemAt(o);let l="";n.source.tilesUrl?l=n.source.tilesUrl.slice(0,-7)+".dzi":n.source.url&&(l=n.source.url),l===a.overlayDziUrl&&(typeof n.setOpacity=="function"&&n.setOpacity(e),n.tiles&&n.tiles.length&&n.tiles.forEach(s=>{s.elmt&&(s.elmt.style.opacity=e)}))}i.value.forceRedraw()}},{immediate:!0});function Sa(e){const r=parseFloat(e.target.value);if(ze.value=r,i.value&&a.overlayDziUrl){const o=i.value.world.getItemCount();for(let n=0;n<o;n++){const l=i.value.world.getItemAt(n);let s="";l.source.tilesUrl?s=l.source.tilesUrl.slice(0,-7)+".dzi":l.source.url&&(s=l.source.url),s===a.overlayDziUrl&&(typeof l.setOpacity=="function"&&l.setOpacity(r),l.tiles&&l.tiles.length&&l.tiles.forEach(u=>{u.elmt&&(u.elmt.style.opacity=r)}))}i.value.forceRedraw(),Ce.value&&typeof Ce.value.setOpacity=="function"&&Ce.value.setOpacity(r>=1?0:1),i.value.forceRedraw()}a.globalOpacity!==void 0&&f("update:globalOpacity",r)}A(()=>a.annotations,()=>{Tt()},{immediate:!0}),qa(()=>{bt(),ht()}),Rt(()=>{typeof window>"u"||(Ve.value=!0,Je(()=>{fa(),Mt().then(()=>{})}))});function za(e=1.2){if(!i.value)return;const o=i.value.viewport.getZoom()*e;return i.value.viewport.zoomTo(o),i.value.viewport.applyConstraints(),i.value.forceRedraw(),o}function _a(e=1.2){if(!i.value)return;const o=i.value.viewport.getZoom()/e;return i.value.viewport.zoomTo(o),i.value.viewport.applyConstraints(),i.value.forceRedraw(),o}function Oa(){return i.value?i.value.viewport.getZoom():null}function Aa(){return i.value?i.value.viewport.getCenter():null}function Ra(e,r){i.value&&(i.value.viewport.zoomTo(e),i.value.viewport.panTo(r),i.value.viewport.applyConstraints(),i.value.forceRedraw())}function Ca(e,r){i.value&&i.value.addHandler(e,r)}return h({showPopup:Ma,zoomIn:za,zoomOut:_a,getZoom:Oa,getCenter:Aa,setZoomAndCenter:Ra,addSyncHandler:Ca}),document.addEventListener("visibilitychange",()=>{document.hidden?ht():Mt()}),{isClient:Ve,viewerContainer:T,viewerId:la,mousePos:Xe,updateMousePosition:Pa,handleRetentionClick:Ta,handleSliderInput:Sa,overlayOpacityLocal:ze,timelineInfo:wa,isPanelMinimized:ka,togglePanelMinimized:ya,svampMycelValue:pa,matsvampMycelValue:ba,rodlistadeMycelValue:xa,rottackePopover:C,rottackePopoverStyle:re,naturvardTooltip:F,naturvardTooltipOpen:Q,naturvardCounter:Y}}},pr=["id"],br={class:"rounded-md border border-[#f9f6f3] bg-white px-3 py-1 text-xs text-neutral-700 shadow"},xr={key:0,class:"absolute top-3 left-3 z-50 pointer-events-none"},wr={class:"inline-flex items-center gap-2 rounded-full border border-[#f9f6f3] bg-white/95 px-3 py-1 text-xs font-medium text-neutral-700 shadow-sm"},Pr={class:"text-sm font-semibold text-neutral-900"},Tr={key:0,class:"text-emerald-600 font-semibold"},Mr={key:1,class:"text-red-500 font-semibold"},Sr={class:"col-span-2"},zr={class:"w-full"},_r={class:"w-full text-md relative group pointer-events-auto"},Or={key:0},Ar={class:"text-3xl mt-2 font-medium"},Rr={class:"text-md text-neutral-500 mb-4"},Cr={key:0,class:"mb-6"},Ir={key:1,class:""};function Lr(a,f,h,c,O,q){const G=Ba;return te(),ie("div",{class:Pe(["relative",h.fullscreenLayout?" gap-4":"grid md:grid-cols-5 gap-8"])},[c.isClient?(te(),ie("div",{key:0,id:c.viewerId,class:Pe(["openseadragon-viewer ui-zoom-exempt col-span-3 relative overflow-hidden",h.fullscreenLayout?"":"rounded-sm"]),ref:"viewerContainer",onMousedownCapture:f[0]||(f[0]=(...E)=>a.handleActivate&&a.handleActivate(...E)),onMousemove:f[1]||(f[1]=(...E)=>c.updateMousePosition&&c.updateMousePosition(...E)),onClick:f[2]||(f[2]=E=>c.handleRetentionClick(E))},[Da(U("div",{class:"absolute z-[60] pointer-events-none",style:Ye(c.naturvardTooltip?{left:c.naturvardTooltip.left+"px",top:c.naturvardTooltip.top+"px"}:{})},[U("div",br,pe(c.naturvardTooltip&&c.naturvardTooltip.message),1)],4),[[Ga,c.naturvardTooltipOpen&&c.naturvardTooltip]]),c.naturvardCounter?(te(),ie("div",xr,[U("div",wr,[f[3]||(f[3]=U("span",{class:"uppercase tracking-wide text-[10px] text-neutral-400"},"Naturvård",-1)),U("span",Pr,pe(c.naturvardCounter.total),1),c.naturvardCounter.gained?(te(),ie("span",Tr,"+"+pe(c.naturvardCounter.gained),1)):de("",!0),c.naturvardCounter.lost?(te(),ie("span",Mr,"-"+pe(c.naturvardCounter.lost),1)):de("",!0)])])):de("",!0),ct(G,{class:"hover:cursor-pointer","open-delay":500,"close-delay":300},{content:Ot(()=>[...f[4]||(f[4]=[U("div",{class:"p-3 max-w-xs"}," I princip är hela området täckt av rötter där svampar kan överleva ",-1)])]),default:Ot(()=>[U("div",{style:Ye(c.rottackePopover.visible?c.rottackePopoverStyle:{position:"absolute",top:"-99999px",left:"-99999px",width:"1px",height:"1px",pointerEvents:"none"}),class:"absolute z-[10000]",tabindex:"0",role:"button","aria-label":"Kontinuerligt rottäcke"},null,4)]),_:1})],42,pr)):de("",!0),U("div",Sr,[U("div",{class:Pe(["pointer-events-none bottom-0  z-10",(h.layoutMode==="slider"&&h.comparisonMode,"w-full")]),style:Ye({zIndex:10,...h.sliderPosition==="left"?{left:"0px",paddingRight:(h.layoutMode==="slider"&&h.comparisonMode,"0px")}:{right:"0px",paddingLeft:(h.layoutMode==="slider"&&h.comparisonMode,"0px")}})},[U("div",zr,[h.fullscreenLayout?de("",!0):(te(),ie("div",{key:0,class:Pe(["flex w-full",h.sliderPosition==="left"?"":"justify-end"])},[U("div",_r,[c.isPanelMinimized?de("",!0):(te(),ie("div",Or,[U("h1",Ar,pe(h.frameworkLabel),1),U("h1",Rr,pe(h.timeLabel),1),c.timelineInfo?(te(),ie("p",Cr,pe(c.timelineInfo.skog),1)):de("",!0),c.timelineInfo?(te(),ie("p",Ir,[f[5]||(f[5]=U("div",{class:"font-bold mb-1.5 text-lg"},"Påverkan på mykorrizasvamp",-1)),Wa(" "+pe(c.timelineInfo.svamp),1)])):de("",!0),f[6]||(f[6]=U("div",{class:"overflow-hidden mt-1 px-2 w-full flex"},null,-1))]))])],2))])],6)])],2)}const Ur=Object.assign(Yt(hr,[["render",Lr],["__scopeId","data-v-bae59633"]]),{__name:"OpenSeadragonViewer"});export{Ur as default};
