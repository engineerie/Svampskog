import{cb as $,cc as E,cd as S,r as _,ai as m,ax as A,ce as D}from"./UbyS27mO.js";const L=/^[^-]+.*-.*[^-]+$/,j=/^[^_]+.*_.*[^_]+$/,b=["arrowleft","arrowright","arrowup","arrowright","tab","escape","enter","backspace"];function h(l){return/^[a-z]$/i.test(l)?`Key${l.toUpperCase()}`:/^\d$/.test(l)?`Digit${l}`:/^f\d+$/i.test(l)?l.toUpperCase():{space:"Space",enter:"Enter",escape:"Escape",tab:"Tab",backspace:"Backspace",delete:"Delete",arrowup:"ArrowUp",arrowdown:"ArrowDown",arrowleft:"ArrowLeft",arrowright:"ArrowRight"}[l.toLowerCase()]||l}function C(l,u={}){const i=_([]),f=()=>{i.value.splice(0,i.value.length)},v=$(f,u.chainDelay??800),{macOS:w}=E(),d=D(),c=u.layoutIndependent??!1,I=b.map(e=>h(e)),g=e=>{if(!e.key)return;const a=c?/^Key[A-Z]$/i.test(e.code):/^[a-z]{1}$/i.test(e.key),t=c?I.includes(e.code):b.includes(e.key.toLowerCase());let r;if(i.value.push(c?e.code:e.key),i.value.length>=2){r=i.value.slice(-2).join("-");for(const n of K.value.filter(s=>s.chained))if(n.key===r){n.enabled&&(e.preventDefault(),n.handler(e)),f();return}}for(const n of K.value.filter(s=>!s.chained)){if(c){if(e.code!==n.key)continue}else if(e.key.toLowerCase()!==n.key)continue;if(e.metaKey===n.metaKey&&e.ctrlKey===n.ctrlKey&&!((a||t||n.shiftKey||e.shiftKey)&&e.shiftKey!==n.shiftKey)){n.enabled&&(e.preventDefault(),n.handler(e)),f();return}}v()},y=m(()=>{const e=d.value?.tagName,a=d.value?.contentEditable;return e==="INPUT"||e==="TEXTAREA"||a==="true"||a==="plaintext-only"?d.value?.name||!0:!1}),K=m(()=>Object.entries(A(l)).map(([e,a])=>{if(!a)return null;let t;e.includes("-")&&e!=="-"&&!e.includes("_")&&!e.match(L)?.length&&console.trace(`[Shortcut] Invalid key: "${e}"`),e.includes("_")&&e!=="_"&&!e.match(j)?.length&&console.trace(`[Shortcut] Invalid key: "${e}"`);const r=e.includes("-")&&e!=="-"&&!e.includes("_");if(r)c?t={key:e.split("-").map(o=>h(o)).join("-"),metaKey:!1,ctrlKey:!1,shiftKey:!1,altKey:!1}:t={key:e.toLowerCase(),metaKey:!1,ctrlKey:!1,shiftKey:!1,altKey:!1};else{const s=e.toLowerCase().split("_").map(p=>p);let o=s.filter(p=>!["meta","command","ctrl","shift","alt","option"].includes(p)).join("_");c&&(o=h(o)),t={key:o,metaKey:s.includes("meta")||s.includes("command"),ctrlKey:s.includes("ctrl"),shiftKey:s.includes("shift"),altKey:s.includes("alt")||s.includes("option")}}if(t.chained=r,!w.value&&t.metaKey&&!t.ctrlKey&&(t.metaKey=!1,t.ctrlKey=!0),typeof a=="function"?t.handler=a:typeof a=="object"&&(t={...t,handler:a.handler}),!t.handler)return console.trace("[Shortcut] Invalid value"),null;let n=!0;return a.usingInput?typeof a.usingInput=="string"&&(n=y.value===a.usingInput):n=!y.value,t.enabled=n,t}).filter(Boolean));return S("keydown",g)}export{C as d};
