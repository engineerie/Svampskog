import{A as Q,aR as X,r as u,I as b,aL as Y,aM as Z,aN as ee,W as y,d as T,f as L,e as v,h as l,g as n,ap as te,N as se,w as p,a8 as ae,a$ as le,F as ne,a6 as oe,L as ie,n as re,av as ue,t as C}from"./B5DmKwMt.js";import{_ as me}from"./DiBmbWKQ.js";import{_ as ce}from"./DYFelV31.js";import{_ as de}from"./D_j4kfuY.js";import{_ as fe}from"./DcoIRwH5.js";import{u as ve}from"./B5Ao5OUK.js";import"./BW_RWYSS.js";import"./YtaohyNp.js";import"./BstbYvQo.js";import"./DF0qlwp-.js";import"./3QI4qJev.js";const pe={key:0,class:"flex flex-col gap-4 min-w-0 max-w-full"},ge={class:"flex w-full justify-between items-center"},_e={key:0,class:"text-sm text-muted mt-1"},ke={class:"relative w-full aspect-video"},he=["src","alt"],xe=["src","alt"],we={class:"flex items-center gap-2 text-xs text-neutral-500"},be={class:"flex cursor-help"},ye={class:"flex flex-col gap-2 p-4"},Te={class:"flex w-full"},Ce={class:"flex w-full justify-between"},ze={class:"flex w-full justify-between"},$e={class:"w-full max-w-full min-w-0 overflow-x-auto overflow-y-visible"},Ne={class:"flex flex-nowrap whitespace-nowrap gap-2 w-full my-1"},Se={class:"space-y-2"},Ae={class:"text-xl font-semibold text-neutral-900"},Ie={class:"text-md text-muted"},Ue={class:"text-md"},je=Q({__name:"SkogsskotselTimeline",props:{frameworkId:{}},async setup(F){let c,z;const B=F,g=X("skogsskotselFramework",null),M=ve(),H=y(()=>B.frameworkId||g?.id?.value||""),d=g?.startskog??u("naturskog"),$=g?.timelineTime??u(void 0),N=y({get:()=>d.value,set:e=>{d.value=e}}),_=u(!1),k=u(1),m=u(null),i=u(0),S=[{label:"Inte kalavverkad",value:"naturskog"},{label:"Kalavverkad",value:"produktionsskog_"}],O=S.map(e=>({label:e.label,value:e.value,icon:e.value==="naturskog"?"i-material-symbols-light-forest-rounded":"i-ph-farm"}));b(d,e=>{const t=S.findIndex(s=>s.value===e);t!==-1&&(M.selectedStartskog=t)});const A=e=>{const t=e?.toLowerCase?.()??"";return t==="intekalavverkad"?"naturskog":t==="produktionsskog"?"produktionsskog_":e},I=e=>(e?.toLowerCase?.()??"")==="ingenatgard"?"naturskydd":e,h=e=>{const t=String(e).trim().toLowerCase();return t.includes("efter")?"efter":t.includes("innan")||t.includes("före")||t.includes("fore")?"före":t.replace(/[^0-9]/g,"")||t},U=(e,t,s,a="visa_visa")=>{const f=x=>x.trim().toLowerCase().replace(/[^a-z0-9_åäö]+/g,"_").replace(/_+/g,"_");return`/images/thumbnails/${`${f(e)}_${h(String(t))}_${a}_${f(s)}.webp`}`},{data:q}=([c,z]=Y(()=>Z("forestry-timeline-skogsskotsel",()=>ee("forestryTimelines").first())),c=await c,z(),c),r=y(()=>{const e=q.value?.entries??[],t=H.value,s=I(t);return e.map(a=>({...a,startskog:A(a.startskog),atgard:I(a.atgard)})).filter(a=>a.startskog===A(d.value)&&a.atgard===s).map(a=>({tid:a.tid,skog:a.skog,svamp:a.svamp,thumb:U(a.atgard,a.tid,a.startskog,"visa_visa"),thumbHidden:U(a.atgard,a.tid,a.startskog,"visa_dölj")}))});function P(){m.value?.emblaApi?.scrollPrev?.()}function D(){m.value?.emblaApi?.scrollNext?.()}function E(e){i.value=e}function K(e){i.value=e,m.value?.emblaApi?.scrollTo?.(e)}b(r,e=>{i.value=0,$.value=j(e[0]?.tid),e.length&&requestAnimationFrame(()=>{m.value?.emblaApi?.scrollTo?.(0)})});const j=e=>{if(!e)return;const t=h(e);if(t==="före")return"före";if(t==="efter")return"efter";const s=Number(t);if(!Number.isNaN(s))return String(s)};b(i,()=>{const e=r.value[i.value]?.tid;$.value=j(e)});function R(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}function W(e){if(!e)return"";const t=h(e);if(t==="före")return"Innan avverkning";if(t==="efter")return"Efter avverkning";const s=Number(t);return Number.isNaN(s)?e.charAt(0).toUpperCase()+e.slice(1):`${s} år efter avverkning`}return(e,t)=>{const s=te,a=me,f=ce,V=le,x=de,G=ue,J=fe;return r.value.length?(v(),T("div",pe,[l("div",ge,[t[3]||(t[3]=l("span",{class:"text-md"},"Har skogen varit kalavverkad tidigare?",-1)),n(s,{name:"i-heroicons-question-mark-circle",class:"size-5 cursor-pointer",onClick:t[0]||(t[0]=o=>_.value=!_.value)})]),_.value?(v(),T("div",_e," Tidigare kalavverkning påverkar vilka mykorrhizasvampar som finns. Framförallt är naturvårdssvampar vanligare i skogar som inte har kalavverkats. ")):L("",!0),n(a,{items:se(O),modelValue:N.value,"onUpdate:modelValue":t[1]||(t[1]=o=>N.value=o),variant:"link",size:"lg",class:"w-full -mb-3 -mt-2 transition-all",ui:{list:"grid grid-cols-2 gap-1 p-1",trigger:" data-[state=active]:text-neutral-900 px-4 py-2 text-sm font-medium"}},null,8,["items","modelValue"]),n(f,{ref_key:"timelineCarousel",ref:m,items:r.value,prev:{onClick:P},next:{onClick:D},class:"w-full bg-neutral-950 overflow-hidden rounded-lg ring-muted/50",fade:"",onSelect:E},{default:p(({item:o})=>[l("div",ke,[l("img",{src:o.thumbHidden,alt:`Foto ${o.tid}`,width:"960",height:"540",class:"w-full h-full object-cover absolute inset-0"},null,8,he),l("img",{src:o.thumb,alt:`Foto ${o.tid}`,width:"960",height:"540",class:"w-full h-full object-cover absolute inset-0 transition-opacity duration-700",style:ae({opacity:k.value})},null,12,xe)])]),_:1},8,["items","prev","next"]),l("div",we,[n(V,null,{content:p(()=>[l("div",ye,[l("div",Te,[n(s,{name:"i-fluent-shape-organic-16-filled",class:"size-6 text-gray-300 z-20"}),n(s,{name:"i-fluent-shape-organic-16-filled",class:"size-6 -ml-4 text-gray-400 z-10"}),n(s,{name:"i-fluent-shape-organic-16-filled",class:"size-6 -ml-4 mr-4 text-gray-500"}),t[4]||(t[4]=l("h1",{class:"font-medium"},"Mykorrhizasvampar",-1))]),l("div",Ce,[n(s,{name:"i-fluent-shape-organic-16-filled",class:"size-6 text-signal-400"}),t[5]||(t[5]=l("h1",{class:"font-medium"},"Naturvårdssvampar",-1))]),l("div",ze,[n(s,{name:"i-fluent-shape-organic-16-filled",class:"size-6 text-yellow-400"}),t[6]||(t[6]=l("h1",{class:"font-medium"},"Matsvampar",-1))])])]),default:p(()=>[l("div",be,[n(s,{name:"i-fluent-shape-organic-16-filled",class:"size-6 text-gray-300 z-20"}),n(s,{name:"i-fluent-shape-organic-16-filled",class:"size-6 -ml-4 text-signal-400 z-10"}),n(s,{name:"i-fluent-shape-organic-16-filled",class:"size-6 -ml-4 text-yellow-400"})])]),_:1}),n(x,{modelValue:k.value,"onUpdate:modelValue":t[2]||(t[2]=o=>k.value=o),min:0,max:1,step:.05,class:"flex-1",color:"neutral"},null,8,["modelValue"]),n(s,{name:"i-mingcute-tree-fill",class:"size-7 text-primary"})]),l("div",$e,[l("div",Ne,[(v(!0),T(ne,null,oe(r.value,(o,w)=>(v(),ie(G,{key:`timeline-thumb-${w}`,color:"neutral",class:re(["ring-muted/50 flex-none shrink-0 justify-center whitespace-nowrap",w===i.value?"border-neutral-900 bg-neutral-900 hover:bg-neutral-900 text-white opacity-100 ring-0 shadow":"border-transparent opacity-60 hover:opacity-100"]),variant:"outline",type:"button",onClick:Ve=>K(w),label:R(o.tid)},null,8,["class","onClick","label"]))),128))])]),n(J,{variant:"soft",class:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-2 ring-muted/50"},{default:p(()=>[l("div",Se,[l("h3",Ae,C(W(r.value[i.value]?.tid)),1),l("p",Ie,C(r.value[i.value]?.skog),1),l("p",Ue,C(r.value[i.value]?.svamp),1)])]),_:1})])):L("",!0)}}}),Re=Object.assign(je,{__name:"SkogsskotselTimeline"});export{Re as default};
